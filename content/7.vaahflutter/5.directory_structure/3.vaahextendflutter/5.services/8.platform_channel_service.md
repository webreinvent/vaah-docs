---
toc: true
title: Platform Channel Service
description: Usage guide for the platform service in vaah flutter.
---
## Overview
The Platform Service implementation facilitates communication between Flutter and native platform code. This is achieved using method channels for invoking methods and event channels for streaming events. The [`PlatformService`](../../../4.core/platform_service.md)class provides static methods to interact with these channels, making it easy to invoke native methods and listen to event streams.

## Usage Guide

### Setup

Provide the method channel name in any of the environment configuration file.

For Example in `assets/env/develop.json` add the following key.

```json
"method_channel_name": "your-method-channel-name",
```

### Invoke a method 

You can use the `PlatformService.invokeMethod()` to invoke a method present at native side

- **Signature**: `static Future<T?> invokeMethod<T>(String method, [dynamic arguments])`
- **Parameters**:
  - `method`: The name of the method to be invoked.
  - `arguments`: Optional arguments to be passed to the method.
- **Returns**: A `Future` which completes to the result of the method invocation, or throws an exception if the invocation fails.

**Example**:
```dart
final int sum = await PlatformService.invokeMethod<int>('getSum', {'a': 10, 'b': 20});
print(sum); // 30
```

### Get an Event Stream 

You can use `PlatformService.getEventStream` to get a stream of events from the native side.

- **Signature**: `static Stream<dynamic> getEventStream(String eventChannelName, [dynamic arguments])`
- **Parameters**:
  - `eventChannelName`: The name of the event channel.
  - `arguments`: Optional arguments to be passed to the event channel.
- **Returns**: A broadcast `Stream` which emits events from the native side.

**Example**:

```dart
final myStream = PlatformService.getEventStream('com.example.app/battery');
```

## Source Code

### BasePlatformService class

```dart
abstract class BasePlatformService {
  Future<T?> invokeMethod<T>(String method, [dynamic arguments]);
  Stream<dynamic> getEventStream(String eventChannelName, [dynamic arguments]);
}
```

### PlatformChannelService Class 

```dart
import 'package:flutter/services.dart';

import '../../../env/env.dart';
import 'base_service.dart';

class PlatformChannelService implements BasePlatformService {
  final String _methodChannelName = EnvironmentConfig.getConfig.methodChannelName;
  static final Map<String, EventChannel> _eventChannels = {};

  @override
  Future<T?> invokeMethod<T>(String method, [dynamic arguments]) async {
    final MethodChannel channel = MethodChannel(_methodChannelName);
    try {
      final result = await channel.invokeMethod<T>(method, arguments);
      return result;
    } on MissingPluginException catch (e) {
      if (channel.name.isEmpty) {
        throw 'Please provide correct method_channel_name in env config: ${e.message}';
      }
      throw 'No plugin handler for the method call was found: ${e.message}(${channel.name})';
    } on PlatformException catch (e) {
      throw 'Failed to invoke method: ${e.message}';
    }
  }

  @override
  Stream<dynamic> getEventStream(String eventChannelName, [dynamic arguments]) {
    if (!_eventChannels.containsKey(eventChannelName)) {
      _eventChannels[eventChannelName] = EventChannel(eventChannelName);
    }
    return _eventChannels[eventChannelName]!.receiveBroadcastStream(arguments);
  }
}
```