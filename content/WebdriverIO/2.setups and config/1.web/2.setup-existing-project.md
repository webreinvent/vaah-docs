
# Setup Existing Project
This documentation outlines the setup procedures for our existing WebDriverIO project. It is designed to serve as a guide for both new team members joining the project and existing contributors seeking a clear reference on the project's setup.

## Project with Appium
In this, we are setting up a "project with appium" on a new system. To run the test scripts, we need to install all the dependencies in the file `package.json` file. We also need to install few more packages before start working on the test scripts.

Follow the steps mentioned below:

1. Clone the repository of the project that has WebdriverIO with appium configured.
2. Open the cloned project in Code Editor.
3. Open the terminal of that folder. Look for the terminal option on the Code Editor.
4. The path in the terminal window should contain the project folder name.
5. Run the follwing command:
    ```shell
    npm install
    ```
6. After the command Ran successfully. Update the chrome browser to the latest version.
7. Run the following command to update the appium-chromium-driver
    ```shell
    npm i appium-chromium-driver --save-dev
    ```
8. Now, all the neccessary packages are installed.
9. Before running the test script. We need to verify the path of under the specs keyword in file `wdio.conf.js`.
    ```js
    specs: [
        './test/specs/**/*.js'
    ],
    ```
    ::alert{type="info"}
    Note:
    - In the path "*" symbol indicates that the run command will run all the test files inside the spec folder.
    - You can replace "*" symbol with a specific test file. Run comand will run only that test file.
    - For run command refer to the steps given below.
    ::
10. To run the test script, run command:
    ```shell
    npx run wdio
    ```
::alert{type="danger"} 
**Possible Error:**
- Error: Request failed with status 500 due to unknown error
- Solution: To solve this error. Follow these steps:
    1. Update the chrome browser to the latest version.
    2. Run the following command to update the appium-chromium-driver.
        ```shell
        npm i appium-chromium-driver --save-dev
        ```

- If the issue remains, follow these steps to solve the issue:
    1. Change the version of `appium-chromium-driver` from **^1.3.7** to **1.2.60** package in `package.json` file.
    2. Run `npm install`.
    3. Then the run the test cases using `npm run wdio`.
    4. To find the campatible chrome driver for appium, refer to the [list of released versions](https://www.npmjs.com/package/appium-chromium-driver?activeTab=versions) of appium-chromium-driver. 
::


## Project without Appium

In this, we are setting up a "project that does not have appium". The project will have webdriverio installed in it. We have to add appium service in the project. We also need to add multiple dependencies for appium to work properly.

Follow the steps mentioned below:

1. Clone the repository of the project that has WebdriverIO but no appium.
2. Open the cloned project in Code Editor.
3. Open the terminal of that folder. Look for the terminal option on the Code Editor.
4. The path in the terminal window should contain the project folder name.
5. Before working on the configuration, To verify if webdriverio is installed on the project or not, run the command given below:
    ```shell
    npx wdio --version
    ```
    The version of webdriverIO installed on the project should be visible.

### Remove Unnecessary Dependencies
Since, we are going to use Appium service for the automation test, we need to remove few unnecessary dependencies from `package.json` file. 

Delete the following packages from `package.json` file:

1. Remove all the packages with prefix: **@wdio** in `package.json` file.
2. Remove all the packages that contains term **wdio**.
3. Remove the **webdriverio** package if it exists in `package.json` file.
4. Remove the **chromedriver** package if it exists in the file.

Now, all the unnecessary files have been removed from `package.json` file.

### Install Dependencies
1. To install appium and other related dependencies. Follow all the steps given in **Install Dependencies** section of [Setup New Project Documentation](1.setup-new-project.md).
2. After completed the above steps, add the following lines in the script section of `package.json` file:
    ```json
     "scripts": {
        "dev": "vite",
        "build": "vite build",
        ... //Other scripts
    },
    ```

### Configure ENV File
To configure the `wdio.env.js` file, follow all the steps given in the **Configure ENV file** section of [Setup New Project Documentation](1.setup-new-project.md).

### Configure `wdio.conf.js` File
Follow the steps given below to configure `wdio.conf.js` file:

1. Remove the given code from the top of the file:
    ```js
    const env = require('./wdio.env');
    ```
    Add this code given below in place of the above:
    ```js
    import env from "./wdio.env.js";
    ```
2. Replace `exports.config` to `export const config`. Refer to the code snippet below:
    ```js
    export const config = {
        ...
    }
    ```
3. Search for `services` inside "export const config". If it is not present add the code mentioned below. If it is present, replace the `services` with the below code.
    ```js
    export const config= {
        ...
        services: [
            [
                'appium',
                {
                    args:{
                        allowInsecure: ['chromedriver_autodownload', 'adb_shell'],
                    }
                }
            ]
        ],
        ...
    }
    ```

### Configuring Test Script
To successfully run the test script, we need to do some changes to the test script.

#### Configure Helper Files
At first we need to configure the helper file. Open all the files present in `tests/wdio/vaah-webdriverio` directory.
Now, follow the steps given below and do the changes to all the files in the directory.

1. Remove the require statements and use import statements to import the class from the file. **For example:**.
    ```js
    const env = require('./../../../wdio.env'); //require statement (Remove this)
    import env from '../../../wdio.env.js'      //import statement (Use this)
    ```
    ::alert{type="danger"}
    Note:
    - You need replace every require statement with import statements for each file. 
    - Make sure that name of the import should match with the class name of the file which you are trying to import.
    - Eg: `import env from '../../../wdio.env.js'`.  Here **env** should be the class name in the file `wdio.env.js`.
    ::
2. Add `export default` statement in front of the class name in all the files. **For example:**
    ```js
    export default class [class_name]{
        ...
    }
    ```
3. Remove the last line which contains `module.exports = ...` from every file.
4. Add the statment given below to create an object of a class you are importing.
    ```js
    import Selector from '../vaah-webdriverio/Selector.js'
    const Sl = new Selector(); //Object for Selector class
    ```
    ::alert{type="warning"}
    Note:
    - Here we are using importing **Selector** class from `Selector.js` file
    - Next, we are creating an object **Sl** for *Selector* class.
    - Now, **Sl** can be used to call the functions within the *Selector* class.
    - For the classes **chalk** and **color**. Creating an object is not required.
    ::

   

#### Configure Data File
At first we need to configure the data file. Open all the data files present in `tests/wdio/data` directory.
Now, follow the steps given below. (Do these changes to all the data files)
1. Replace the code from the top of the file:
    ```js
    const Page = require('../vaah-webdriverio/Page'); //Remove this
    import Page from '../vaah-webdriverio/Page.js'    //Add this
    ```
2. Add `export default` statement in front of the class name. For Example:
    ```js
    export default class [class_name] extends Page{
        ...
    }
    ```

#### Configure Page Object File
For this, Follow all the steps given in the section **Configure Helper Files**. Do the suggested changes on all the page object files.

#### Configure Spec Files
Follow step 1 and 4 of section: **Configure Helper Files**. Do the suggested changes on all the spec files. 


### Running the Test Script
To run the test script, follow the steps given in the **Running the test script** section of [Setup New Project Documentation](1.setup-new-project.md).

