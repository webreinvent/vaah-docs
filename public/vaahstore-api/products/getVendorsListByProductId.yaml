get:
  tags:
    - Products
  summary: Get Vendors List for Product By Product ID
  description: |
    This endpoint retrieves a list of vendors associated with a specific product.
    It returns vendor details, including the quantity available and their price range.
    Additionally, it checks for any missing default vendors and includes them in the response.
  operationId: getVendorsListForProduct
  parameters:
    - name: id
      in: path
      required: true
      description: The ID of the product for which to retrieve the vendors.
      schema:
        type: integer
        example: 1
    - '$ref': '../vaahstore.yaml#/components/parameters/currency'
    - name: variation_id
      in: query
      description: >
          Pass this query parameter to retrieve vendors specifically for the given product variation.
          If provided, the response will include pricing and other details relevant to the selected variation.
      required: false
      schema:
          type: integer
          example: 2
  responses:
    200:
      description: Successfully retrieved the list of vendors.
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: true
              data:
                type: array
                items:
                  type: object
                  properties:
                    id:
                      type: integer
                      example: 10
                      description: Unique identifier for the vendor.

                    name:
                      type: string
                      example: "Mrs. Pat Borer Sr."
                      description: Name of the vendor.

                    slug:
                      type: string
                      example: "default-vendor-9"
                      description: Slug for the vendor used in URLs or references.

                    is_default:
                      type: boolean
                      nullable: true
                      example: null
                      description: Indicates if this vendor is marked as default for the product.

                    email:
                      type: string
                      nullable: true
                      example: null
                      description: Email address of the vendor, if available.

                    phone_number:
                      type: string
                      nullable: true
                      example: null
                      description: Contact phone number of the vendor.

                    years_in_business:
                      type: integer
                      nullable: true
                      example: null
                      description: Number of years the vendor has been in business.

                    services_offered:
                      type: string
                      nullable: true
                      example: null
                      description: Description of services offered by the vendor.

                    status_notes:
                      type: string
                      example: "Default Vendor Status"
                      description: Notes or remarks about the vendor's status.

                    quantity:
                      type: integer
                      example: 0
                      description: Available quantity from the vendor.
                    price:
                      type: string
                      example: "30.76"
                      description: Final calculated or listed price of the product for this vendor.

                    product_price_range:
                      type: array
                      items:
                        type: number
                      example: [ 20.16, 31.25 ]
                      description: Minimum and maximum price range of the product for this vendor.

                    product_vendor_id:
                      type: integer
                      example: 33
                      description: ID of the vendor specific to this product relationship.

                    vh_st_product_id:
                      type: integer
                      example: 49
                      description: Product ID related to this vendor.

                    is_preferred:
                      type: boolean
                      nullable: true
                      example: null
                      description: Indicates if the vendor is preferred for this product.


              message:
                type: boolean
                example: false
    404:
      description: Product not found or no vendors associated.
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              message:
                type: string
                example: "Product not found or no vendors associated."
    400:
      description: Bad Request.
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              message:
                type: string
                example: "Invalid product ID."

post:
  tags:
    - Products
  summary: Attach vendors to a product
  description: |
    This endpoint allows you to create or attach vendors to a specific product.
    By providing the product ID and vendors details, you can associate one or more vendors
    with a product. This operation also verifies if the vendor already exists for the given product
    and includes validation for required fields.

  parameters:
    - name: id
      in: path
      required: true
      schema:
        type: integer
        description: The ID of the product.
        example: 1
  requestBody:
    required: true
    content:
      application/json:
        schema:
          type: object
          required:
            - store
            - vendors
          properties:
            store:
              type: object
              required:
                - id
              properties:
                id:
                  type: integer
                  description: The ID of the store to which this vendor associated..
                  example: 1
            vendors:
              type: array
              items:
                type: object
                required:
                  - id
                  - name
                  - can_update
                  - taxonomy_id_vendor_status

                properties:
                  id:
                    type: integer
                    description: The ID of the vendor.
                    example: 1
                  name:
                    type: string
                    description: The name of the vendor.
                    example: ""
                  taxonomy_id_vendor_status:
                    type: integer
                    description: The status ID of the vendor.
                    example: 1
                  can_update:
                    type: boolean
                    description: Indicates if the vendor can update the product.
                    example: true

                  status_notes:
                    type: string
                    description: Optional notes about the vendor status.
                    example: null
                    nullable: true

  responses:
    200:
      description: Vendors attached successfully.
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: true
              messages:
                type: array
                items:
                  type: string
                example: [ "saved successfully." ]
              data:
                type: object
                description: The product data.
                '$ref': '../vaahstore.yaml#/components/schemas/Product'
    400:
      description: Bad Request, validation errors occurred.
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              errors:
                type: array
                items:
                  type: string
                example: [ "Vendor ID is required.", "Vendor name is required.","This Vendor {vendor_name} already exists." ,"Can Update required"]
    401:
      description: Unauthorized, user does not have permission to create vendor.
      content:
        application/json:
          schema:
            type: object
            properties:
              success:
                type: boolean
                example: false
              message:
                type: string
                example: "Permission denied."
